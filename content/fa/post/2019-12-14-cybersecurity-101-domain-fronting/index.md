+++
title = "امنیت سایبری ۱۰۱ ویژه فعالان حقوق بشر، فعالان مدنی، فعالان سیاسی، روزنامه نگاران و براندازان: تکنیک Domain Fronting گلوله نقره‌ای دور زدن فیلترینگ اینترنت"
slug = "cybersecurity-101-domain-fronting"
date = 2019-12-14T16:41:00+02:00
tags = [ "Censorship", "Cloak", "Cybersecurity", "FLOSS", "FreeBSD", "GNU", "GoQuiet", "LINUX", "Open Source", "Security", "Shadowsocks", "ShadowsocksR", "simple-obfs", "UNIX", "V2Ray", "v2ray-plugin", "VPN" ]
toc = true
+++

بسیار خب. اجازه می‌خواهم پیش از پرداختن به [گلوله نقره‌ای](https://fa.wikipedia.org/wiki/%DA%AF%D9%84%D9%88%D9%84%D9%87_%D9%86%D9%82%D8%B1%D9%87%E2%80%8C%D8%A7%DB%8C) یا [برگ آس](https://fa.wikipedia.org/wiki/%D8%A2%D8%B3) براندازان در دور زدن فیلترینگ اینترنت (مشابه آنچه که در خیزش آبان‌ماه ۹۸ مشاهده شد) یعنی تکنیک Domain Fronting، به مفهومی تحت عنوان Collateral Freedom بپردازم:

{{< blockquote author="ویکی‌پدیا" link="https://en.wikipedia.org/wiki/Collateral_freedom" title="Collateral Freedom" >}}
Collateral freedom is an anti-censorship strategy that attempts to make it economically prohibitive for censors to block content on the Internet. This is achieved by hosting content on cloud services that are considered by censors to be "too important to block," and then using encryption to prevent censors from identifying requests for censored information that is hosted among other content, forcing censors to either allow access to the censored information or take down entire services.

Collateral Freedom، یک استراتژی ضد سانسور است که سعی می‌نماید بلوکه نمودن محتوا بر روی اینترنت برای سانسورچی‌ها را از منظر اقتصادی بسیار پرهزینه و یا غیرقابل جبران نماید. این امر با میزبانی مطالب در سرویس‌های ابری که توسط سانسورچی‌ها "بسیار مهم و غیرقابل بلاک تلقی می‌شود"، و سپس استفاده از رمزگذاری به منظور ممانعت از شناسایی درخواست‌های دسترسی به اطلاعات سانسور شده توسط سانسورچی‌ها، که در میان سایر محتواها میزبانی می‌شوند، میسر می‌شود، که سانسورچی‌ها را مجبور می‌نماید یا اجازه دسترسی به اطلاعات سانسور شده را صادر نموده و یا سرویس‌های متعددی را کاملا از کار بیاندازند.
{{< /blockquote >}}

در واقع Domain Fronting تکنیکی جهت پیاده‌سازی Collateral Freedom می‌باشد که در ادامه مطلب بدان خواهیم پرداخت.

<!--more-->

## سلب مسئولیت

شما با ادامه مطالعه این مطلب، موافقت کامل خود با این توافق نامه را اعلام می‌نمایید:

{{< blockquote author="ممدوو بابائی" link="https://fa.babaei.net" title="لیسانس مطالب منتشر شده در وب سایت" >}}
تمامی محتویات این وب سایت تحت مجوز <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.fa" target="_blank">(CC BY-SA 3.0) Creative Commons Attribution-ShareAlike 3.0 Unported License</a> منتشر شده است. همچنین، تمامی سورس کدهای منتشر شده در این وب سایت تحت لیسانس <a rel="license" href="http://opensource.org/licenses/MIT" target="_blank">MIT License</a> منتشر شده است، مگر آن که به صراحت ذکر شده باشد. تمامی محتویات ارائه شده صرفا جنبه آموزشی و اطلاعاتی داشته و فاقد هرگونه ضمانت، تعهد یا شرایطی از هر نوع می باشد. بایستی توجه نمود که اطلاعات عرضه شده حتی ممکن است دقیق و یا بروز نباشد. هرگونه اطمینان به و یا استفاده از محتویات یا منابع منتشر شده در این وب سایت با مسئولیت مخاطب بوده و نگارنده یا نگارندگان هیچ گونه مسئولیتی در مورد عواقب آن را نخواهند پذیرفت.
{{< /blockquote >}}

## پروتکل TLS چیست؟

[پروتکل TLS](https://fa.wikipedia.org/wiki/%D8%A7%D9%85%D9%86%DB%8C%D8%AA_%D9%84%D8%A7%DB%8C%D9%87_%D8%A7%D9%86%D8%AA%D9%82%D8%A7%D9%84)، جانشین پروتکل قدیمی‌تر SSL (که با استادندارهای امروزی نا‌امن می‌باشد)، یک پروتکل رمزنگاری است که به منظور برقراری یکپارچگی و حفظ حریم خصوصی بین برنامه ها طراحی شده است. متداول ترین کاربرد TLS در HTTPS است که همان HTTP از طریق TLS (یا SSL) می‌باشد. با استفاده از TLS، دو دستگاه کامپیوتر یا موبایل می توانند ارتباطاتی ایمن را از طریق اینترنت برقرار نمایند. این پروتکل مانع از مشاهده، اصلاح یا جعل پیام های بین آنها، توسط نفوذگرها یا استراق‌سمع‌کنندگان می‌شود.

همچنین پروتکل TLS در پروتکل شبکه [QUIC](https://en.wikipedia.org/wiki/QUIC) که در سال 2012 توسط گوگل طراحی شده و هنوز در دست توسعه می‌باشد، مورد استفاده قرار می گیرد. این پروتکل قرار است جایگزین پروتکل‌های HTTP/HTTPS شود. QUIC به جای استفاده از TCP، از UDP بعنوان لایه انتقال داده استفاده می نماید.

آخرین نسخه پروتکل TLS نسخه <code>1.3</code> می‌باشد که در سال 2018 تصویب شده است. TLSv1.3 شامل تغییرات بسیار مهمی است که مهمترین آن‌ها حذف الگوریتم‌های رمزنگاری قدیمی، مستهلک و ناامنی است که نباید در سال 2018 مورد استفاده قرار بگیرند. از دیگر ویژگی‌های این نسخه، سرعت بخشیدن ارتباطات امن از طریق TLS False Start و 0-RTT می‌باشد.

از دیگر تغییرات آخرین نسخه TLS، اجباری نمودن افزونه [SNI](https://en.wikipedia.org/wiki/Server_Name_Indication) می‌باشد.

## SNI چیست؟

افزونه SNI و یا Server Name Indication، یکی از افزونه‌های پیشنهادی تحت [RFC4366](https://tools.ietf.org/html/rfc4366) برای پروتکل امنیتی لایه انتقال می‌باشد که در سال 2006 پیشنهاد شده است.

با [پروتکل HTTP/1.0](https://www.w3.org/Protocols/HTTP/1.0/spec.html)، یک سرور وب تنها قادر به ارائه یک وب سایت بر روی هر آدرس IP بود زیرا راهی برای شناخت نام میزبان استفاده شده برای درخواست سایت نداشت. [پروتکل HTTP/1.1](https://www.w3.org/Protocols/rfc2616/rfc2616.html) مفهوم هدر  Host یا "میزبان" را معرفی نمود که امکان میزبانی چندین وب‌سایت را تحت عنوان [Virtual Host یا میزبان مجازی](https://fa.wikipedia.org/wiki/%D9%85%DB%8C%D8%B2%D8%A8%D8%A7%D9%86_%D9%85%D8%AC%D8%A7%D8%B2%DB%8C) بر روی یک سرور وب میسر می‌نماید. 

در واقع SNI استانداردی معادل همین مفهوم در HTTP/1.1، به منظور میزبانی چندین وب‌سایت با گواهینامه‌های SSL متفاوت بر روی یک سرور وب در [پروتکل HTTPS](https://fa.wikipedia.org/wiki/%D9%BE%D8%B1%D9%88%D8%AA%DA%A9%D9%84_%D8%A7%D9%85%D9%86_%D8%A7%D9%86%D8%AA%D9%82%D8%A7%D9%84_%D8%A7%D8%A8%D8%B1%D9%85%D8%AA%D9%86) می‌باشد. با استفاده از آن یک کلاینت در ابتدای فرآیند اتصال به سرور نام دامین مدنظر خود را که بر روی یک سرور اشتراکی میزبانی می‌شود را تعیین می‌نماید. این امر به سرور اجازه می دهد تا چندین گواهینامه را بر روی همان آدرس IP و شماره پورت TCP یکسان ارائه دهد و از این رو اجازه می دهد تا چندین وب سایت ایمن HTTPS (یا هر سرویس دیگری از طریق TLS) توسط همان آدرس IP، بدون مجبور نمودن تمامی وب‌سایت‌ها به استفاده از یک گواهینامه، ارائه شود.

متاسفانه ایراد امنیتی SNI (که در واقع از اساس یک ضعف امنیتی در پروتکل TLS است) نشت نام هاست (دامین/وب‌سایت) مورد درخواست می‌باشد. این امر بدان دلیل است که رد و بدل نام دامین در SNI به شکل غیررمزگذاری شده یا به اصطلاح امر Plaintext صورت می‌پذیرد که به استراق‌سمع‌کننده اجازه شنود نام هاست درخواستی توسط کاربر را می‌دهد. لذا، چنین آسیب‌پذیری امکان توسعه و اجرای فیلترینگ اینترنت به شکل بسیار کارآمد را در اختیار دولت‌ها قرار می‌دهد.

دلایل واقعی و محکمی جهت اجباری نمودن SNI در آخرین نسخه پروتکل TLS وجود دارد اما از آنجایی که SNI در ایجاد هر اتصال TLSv1.3 نام میزبان را نشت می دهد، نگاهی به [پیش نویس شماره ۰۷ بررسی تکنیک های سانسور در سراسر جهان](https://web.archive.org/web/20191214223457/https://tools.ietf.org/html/draft-hall-censorship-tech-07) بوضوح از نقش آن به عنوان پاشنه آشیل TLS پرده‌برداری می‌نماید.

{{< figure src="/blog/cybersecurity-101-domain-fronting/wireshark-sni-example-fa-babaei-net.webp" alt="نمونه‌ای از شنود درخواست مبتنی بر پروتکل TLS نسخه 1.2 توسط نرم‌افزار Wireshark که بخوبی نام هاست درخواستی کاربر یعنی fa.babaei.net را آشکار می‌سازد" title="نمونه‌ای از شنود درخواست مبتنی بر پروتکل TLS نسخه 1.2 توسط نرم‌افزار Wireshark که بخوبی نام هاست درخواستی کاربر یعنی fa.babaei.net را آشکار می‌سازد" >}}

بدلیل آسیب‌پذیری فوق‌الذکر، یک بروزرسانی تحت عنوان ESNI سرنام عبارت Encrypted SNI یا SNI رمزگذاری شده، مطرح شده است که در حال حاضر در مرحله آزمایشی به سر می‌برد. نتیجه هرچه که باشد، پیاده‌سازی کامل آن بر روی بستر وب بدلیل آنکه چندین سال طول می‌کشد تا تمامی دستگاه‌های کاربران اینترنت از نسخه‌های جدیدتر پروتکل‌ها پشتیبانی نمایند، عملا میسر نمی‌باشد. برای مثال TLSv1.2 در سال ۲۰۰۸ منتشر شده است در حالیکه نسخه نهایی TLVSv1.3 در سال ۲۰۱۸ منتشر شده است. لذا بعنوان نمونه مرورگرها یا دستگاه‌های موبایل قدیمی که پیش از این تاریخ عرضه شده‌ و دیگر بروزرسانی نمی‌شوند امکان استفاده از وب‌سایت‌های فعال با نسخه TLSv1.2 را نخواهند داشت. بنابراین تمامی وب‌سایت‌ها بدلیل سازگار ماندن با کاربران قدیمی‌تر، هنوز به پروتکل TLVSv1.3 کوچ ننموده‌اند. پس نمی توان انتظار داشت که به محض عرضه ESNI سریعا تمامی سرورهای وب آنرا به شکل پیش‌فرض فعال نمایند و یا حتی توسط تمامی کاربران قابل استفاده باشد.

بسیار خب، با این اوصاف راه حل چیست؟ پاسخ این است: تکنیکی آزموده شده تحت عنوان Domain Fronting!

## تکنیک Domain Fronting چیست؟

اجازه دهید تشریح تکنیک Domain Fronting را جهت درک بهتر با مثالی ساده شده از دنیای واقعی شروع نمایم.

فرض کنید در شهر یا روستای کوچکی یک خوابگاه دانشجویی وجود داشته باشد که تعدادی دانشجو در آن زندگی می‌نمایند. دست بر قضا مامور پست با یکی از این دانشجویان خصومت شخصی دارد و نامه‌ها یا بسته‌هایی که برای وی ارسال می‌شود و نام او بر روی آن‌ها ذکر شده است را به جای تحویل به آن شخص، دور بیاندازد. البته مامور پست بدلیل آنکه بسته در صندوقچه امنی قرار گرفته امکان گشودن بسته را ندارد اما به جهت انتقام آن را سر به نیست می‌کند که امری امکان‌پذیر و ساده‌تر می‌نماید.

خب راه حل دور زدن این مامور پست چیست؟

ساده‌ترین راه‌حل ممکن که در ذهن تداعی می‌شود، نوشتن نام دانشجوی دیگری بر روی بسته پستی می‌باشد. مامور پست با نگاه به نام روی بسته هرگز متوجه نخواهد شد که مقصد بسته دانشجوی مدنظر ما خواهد بود. لذا بسته مثلا به دانشجوی هم‌اتاقی دانشجوی هدف تحویل خواهد شد و می‌توان با یادداشتی در درون بسته که مامور پست از آن اطلاعی ندارد یا هماهنگی قبلی در نهایت بسته را به دست دانشجوی مورد‌نظر رساند.

در واقع Domain Fronting از مفهومی مشابه مثال فوق جهت ارسال موفقیت‌آمیز درخواست‌ها به وب‌سایت سانسور شده استفاده می‌نماید.

تکنیک Domain Fronting به منظور مبهم‌نمودن فیلد SNI در یک اتصال TLS کاربرد دارد که به طور بسیار موثری در هنگام آغاز اتصال به یک سرور، قادر به پنهان سازی نام دامنه هدف می‌باشد. این امر نیازمند یافتن یک ارائه دهنده خدمات میزبانی یا CDN (مخفف Content Delivery Network یا شبکه تحویل محتوا) می‌باشد كه دارای گواهینامه‌ای است كه از چندین دامنه هدف (معروف به SAN سرنام واژه فنی Subject Alternative Names) پشتیبانی نموده و حداقل یکی از دامنه‌های آن فیلتر نباشد. چنانچه دامنه یا وب‌سایت تحت سانسور خود را بر روی سرور و یا شبکه تحویل محتوای آن‌ها قرار دهید، قادر خواهید بود که در زمان برقراری اتصال با دستکاری نمودن و تغییر فیلد SNI درخواست مبتنی بر HTTPS خود، وانمود نمایید که می‌خواهید به یکی از دامین‌های فیلترنشده دسترسی نمایید در حالیکه که در بدنه آن درخواست، درست مشابه مثال خوابگاه دانشجویی، درخواست را به دامین هدف ارسال می‌نمایید!! بله، مانند رونالدینیو سمت چپ را نگاه می‌کنید ولی پاس را به سمت راست ارسال می‌کنید!

{{< figure src="/blog/cybersecurity-101-domain-fronting/domain-fronting-gae-certificate.webp" alt="گواهینامه SSL شرکت گوگل" title="گواهینامه SSL شرکت گوگل" >}}

باور کنید یا نه، این روش بخوبی از پس دور زدن هر نوع فیلترینگ احتمالی در ایران از جنس آنچه که در خیزش آبان‌ماه ۹۸ مشاهده نمودیم برخواهد آمد. در واقع Domain Fronting یک ایده نو نمی‌باشد بلکه سال‌هاست از آن در دور زدن فیلترینگ در کشورهایی نظیر چین، روسیه، مصر، عمان، قطر، و امارت متحده عربی استفاده شده است. حتی بدلیل پشتیبانی از ویژگی تحت عنوان [Pluggable Transports](https://www.torproject.org/docs/pluggable-transports.html.en) در شبکه و نرم‌افزار Tor یک به اصطلاح PT برای آن به منظور دور زدن فیلترینگ با استفاده از تکنیک Domain Fronting تحت عنوان [meek](https://trac.torproject.org/projects/tor/wiki/doc/meek) توسعه داده شده است.

علاوه بر این‌ها پیام‌رسان بسیار امن سیگنال بمدت یک‌سال و نیم از این تکنیک جهت دور زدن فیلترینگ این پیام‌رسان در کشورهای مصر، عمان، قطر، و امارت متحده عربی استفاده نموده است. این در حالیست که این کار به هیچ تنظیم و یا عملی از سوی کاربران نیاز نداشته است. آنها به راحتی می توانسته‌اند برنامه را نصب نموده و از آن به طور عادی استفاده نمایند.

سیگنال برای انجام این مهم از سرویس‌های Amazon Cloudfront و Google App Engine استفاده نموده است. متاسفانه بدلیل تفسیر نادرست کمپانی گوگل از تحریم‌های وضع شده در مورد ایران، آن‌ها تمامی آدرس‌های IP از ایران را بلاک نموده‌اند. لذا با وجود این‌که درخواست‌ها با کمک تکنیک Domain Fronting از فیلترینگ ایران رد می‌شده است، بدلیل بلاک شدن آن‌ها توسط گوگل امکان سرویس‌دهی این پیام‌رسان به شکل مستقیم به کاربران ایرانی مهیا نشده است. علی‌رغم فشارهای وارده بر گوگل و شکست خوردن تلاش‌های لابی‌گرانه برای ارائه این قابلیت به کاربران ایرانی، شرکت گوگل تصمیم به از کارانداختن کامل ویژگی Domain Fronting در سرورهای Google App Engine می‌نماید. لذا توسعه‌دهندگان سیگنال تصیمیم به سوییچ به سرورهای Amazon Cloudfront می‌گیرند.

از آنجایی که سیگنال یک پروژه [متن‌باز یا Open Source](https://fa.wikipedia.org/wiki/%D9%85%D8%AA%D9%86%E2%80%8C%D8%A8%D8%A7%D8%B2) می‌باشد و [کد آن در وب‌سایت GitHub میزبانی می‌شود](https://github.com/signalapp)، فردی کامیت تغییرات در کد سیگنال را در گیت‌هاب این شرکت مشاهده نموده و با ارسال آن به وب‌سایت [Hacker News](https://news.ycombinator.com/) باعث محبوب شدن پست توسط کاربران، رسیدن آن به صفحه آغازین HN و دیده شدن آن توسط مسئولان شرکت آمازون می‌شود. علی‌رغم آنکه Domain Fronting عملی برخلاف توافقنامه استفاده از سرویس کلادفرانت نمی‌باشد، آمازون با بهانه نمودن این موضوع اقدام به از کارانداختن این ویژگی در سرویس‌های خود می‌نماید.

[تمامی این جزییات در مطلبی در وبلاگ رسمی پیام‌رسان سیگنال مطرح شده‌اند](https://web.archive.org/web/20191215001252/https://signal.org/blog/looking-back-on-the-front/).

خاطرنشان می‌شود از سوی دیگر بسیاری از جمله [The Verge](https://www.theverge.com/2018/4/30/17304782/amazon-domain-fronting-google-discontinued)،  [FastCompany](https://www.fastcompany.com/40568177/amazon-and-google-bow-to-russian-censors-in-telegram-battle)، و  [Bloomberg](https://www.bloomberg.com/opinion/articles/2018-05-03/telegram-block-gets-help-from-google-and-amazon) معتقدند که این تلاش‌ها از سوی گوگل و آمازون به منظور غیر‌فعال نمودن Domain Fronting تا حدود زیادی ناشی از فشار دولت روسیه بر فعالیت دامنه تلگرام با استفاده از خدمات ابری هر دو شرکت بوده است. در برهه‌ای از زمان دولت روسیه اقدام به بلوکه نمودن بیش از [۱۶ میلیون آدرس IP](https://www.telegraph.co.uk/news/2018/04/17/millions-ip-addresses-blocked-russia-tries-shut-encrypted-messaging/) متعلق به گوگل و آمازون نمود. حاصل این اقدامات از کارافتادن سرویس بازی ایکس‌باکس مایکروسافت، اپلیکیشن یادداشت برداری Evernote، پیام‌رسان وایبر، شبکه اجتماعی روسی Odnoklassniki، وب‌سایت ایستگاه رادیویی Govorit Moskva، سرویس تحویل غذای Ptichka و بسیاری سرویس‌های دیگر بود (Collateral Freedom و خسارت تحمیلی ناشی از آن بر سانسورچی که Collateral Damage نامیده می‌شود، در ذهن تداعی می‌شود).

اما آیا این به این معنی است که Domain Fronting بلااستفاده شده و دیگر کاربردی ندارد؟

همانطور که در ادامه خواهیم دید، پاسخ به این سوال خیر است. چرا که آمازون و گوگل تنها شرکت‌های عمده عرضه CDN و خدمات میزبانی نمی‌باشند. بلکه، سرویس‌های دیگر و بسیار مشهور نظیر Microsoft Azure، Akamai، Fastly، Level 3، Netlify، CDN77، و ... از این ویژگی پشتیبانی می‌نمایند. البته برخی از این سرویس‌ها در شرایط استفاده خود صراحتا استفاده از Domain Fronting را تخلف از سرویس‌های خود تلقی نموده‌اند و برخی دیگر خیر. در ادامه مطلب در قسمت جزییات فنی جزییات بیشتری از این سرویس‌ها را مورد بررسی قرار خواهیم داد.

اما سوال اساسی اینجاست که مگر جمهوری اسلامی در شرایط بحران بطور معمول اقدام به قطع نمودن کامل اینترنت خارج از کشور و یا ایزوله نمودن کامل اینترنت داخلی از خارجی نمی‌نماید؟

پاسخ به این سوال منفی است! اینترنت هرگز در ایران بطور کامل قطع نبوده است. بعنوان مثال، قبلا در مطلبی به [یکی از روش‌های وصل شدن به اینترنت در آن زمان](/blog/cybersecurity-101-secure-shadowsocksr-freebsd-vpn-server/) اشاره نموده بودم. در واقع اینترنت از دسترس بخش عمده‌ای از جامعه ایران بدلیل غافلگیری و نیازمندی به دانش پیچیده فنی خارج شد، در حالی‌که کاربران فنی‌تر داخل کشور سریعا راهکارهای متعددی برای اتصال به اینترنت را در آن شرایط پیدا نمودند. شنیده‌ها حاکی از آن است که حتی ظرف همان چند روز مافیای اینترنت در ایران شکل گرفته بود و مانند نصاب‌های ماهواره، افرادی تحت عنوان نصاب‌های اینترنت آزاد، در ازای مبالغی از ۲۵‌هزارتومان تا مبالغ گزافی در حدود ۱.۵ میلیون تومان در ماه، به درخواست شهروندان تهرانی، برای نصب و راه‌اندازی اینترنت آزاد به درب منازل مراجعه می‌نموده‌اند.

{{< figure src="/blog/cybersecurity-101-secure-shadowsocksr-freebsd-vpn-server/iran-internet-shutdown-circumvention-through-domestic-vps.webp" alt="یکی از روش‌های دسترسی به اینترنت در خلال قطعی اینترنت در اعتراضات سراسری مردمی و ضدحکومتی آبان‌ماه ۱۳۹۸ ایران" title="یکی از روش‌های دسترسی به اینترنت در خلال قطعی اینترنت در اعتراضات سراسری مردمی و ضدحکومتی آبان‌ماه ۱۳۹۸ ایران" >}}

باید توجه داشت که آن چیزی که مدنظر رهبران جمهوری اسلامی است، تاکنون تنها در کشور کره شمالی انجام شده است و تحت عنوان [Kwangmyong و یا کوانگیمونگ](https://en.wikipedia.org/wiki/Kwangmyong_(network)) شناخته می‌شود. این نوع از تفکیک و جداسازی شبکه اینترنت و اینترانت در سطح وسیع حتی در روسیه، چین، کوبا، و یا میانمار نیز اجرا نشده است.

علی‌رغم این‌که جمهوری اسلامی از سال ۲۰۰۶ که [لیست دشمنان اینترنت توسط گزارشگران بدون مرز](https://web.archive.org/web/20120323215225/http://march12.rsf.org/i/Report_EnemiesoftheInternet_2012.pdf) تهیه می‌شده است، همواره پای ثابت این لیست بوده است، خوشبختانه به شکل بلندمدت هرگز توانایی پیاده‌سازی راهکار عملی و موفقیت‌آمیزی جهت کره‌شمالی‌سازی اینترنت ایران نداشته است. شکی نیست که آن‌ها همیشه آرزوی آنرا در سر پرورانده‌ و حتی سعی هم نموده‌اند، اما هرگز موفق نبوده‌اند.

دلیل این امر چیست؟ یعنی واقعا جمهوری اسلامی توانایی قطع نمودن کامل اینترنت را نداشته یا ندارد؟

مطمئن هستم که بسیاری از افراد دست به دست شدن گزارشی از میزان خسارت ۳۷۰ میلیون دلاری ناشی از قطعی اینترنت ایران در یک روز توسط [نت‌بلاکز](https://netblocks.org/) را در شبکه‌های اجتماعی به خاطر دارند (این [محاسبه هزینه‌ها](https://netblocks.org/costs) از طریق وب‌سایت این موسسه در دسترس بود که گویا هم‌اکنون از دسترس خارج شده است):

{{< figure src="/blog/cybersecurity-101-domain-fronting/netblocks-cost-of-internet-shutdown-iran.webp" alt="خسارت ناشی از قطعی اینترنت ایران در یک روز به گزارش نت‌بلاکز" title="خسارت ناشی از قطعی اینترنت ایران در یک روز به گزارش نت‌بلاکز" >}}

باید اذعان داشت که پیش از وابستگی حکومت، مردم، نهادها و سازمان‌های دولتی، آموزشی، کسب و کارها و ... به اینترنت و تکنولوژی شاید امکان کره‌شمالیزه اینترنت نمودن ایران وجود می‌داشت اما امروز بدلایل متعدد این امر میسر نیست. لحظه‌ای را تصور نمایید که:

* هیچ تلفنی اندرویدی یا iOS بروزرسانی نمی‌شود
* ویندوز بر روی کامپیوترها یا لپ‌تاپ‌ها بروزرسانی نمی‌شود
* سرور‌های کسب و کارها، بانک‌ها یا ادارات و ارگان‌ها جهت رفع آسیب‌پذیری بروزرسانی نمی‌شوند؛ هک نمودن آن‌ها دیگر سخت نخواهد بود
* هیچ آنتی‌ویروسی کار نخواهد کرد و لیسانس بسیاری از محصولات امنیتی از کار خواهد افتاد
* سرویس دهنده‌های ایمیل چطور؟
* میلیون‌ها کاربر ایرانی در دسترسی به حساب‌های خود در سرویس‌های داخلی و خارجی بدلیل عدم دسترسی به سرویس‌‌دهندهای ایمیل خود دچار مشکل خواهند شد
* امکان بوکینگ هتل و پرواز خارجی وجود ندارد
* امکان صحبت با بستگان، دوستان و عزیزان از طریق اینترنت وجود نداشته باشد
* صرافی‌ها امکان نقل و انتقال پول را ندارند
* امکان استفاده از اینستاگرام و سایر شبکه‌های اجتماعی وجود نخواهد داشت
* دانشجویان و اساتید دانشگاه‌ها به مقالات علمی و بروز دسترسی نخواهند داشت
* امکان اپلای نمودن برای دانشگاه‌ها و مقاطع تحصیلی بالاتر در خارج از کشور وجود نخواهد داشت
* بسیاری از شرکت‌های نرم‌افزاری جهت توسعه نرم‌افزار‌ها که موردنیاز دولت و بخش خصوصی و مردم باشد به اینترنت دسترسی نداشته باشند
* و بسیاری موارد دیگر

در واقع اگر آن‌ها می‌توانستند این کار را انجام دهند تا حالا انجام داده بودند! نه نشد! بگذارید دوباره جمله‌بندی کنم! آنها می توانند، اما آیا آنها این کار را انجام می دهند؟

آیا بدنه دولت شامل وزیران، معاونت‌ها، کارمندان، نیروهای نظامی و انتظامی و خانواده‌هایشان خود به جمع مخالفان نخواهند پیوست؟ مرزبندی بین خودی با دسترسی به اینترنت آزاد و غیر‌خودی با دسترسی به اینترانت دقیقا کجاست؟

خلاصه کلام آنکه بزعم من اینترنت محدودتر خواهد شد ولی هرگز قطع نخواهد شد؛ حتی به شکل مقطعی آن. اینترنت از دسترس افراد عادی‌تر خارج خواهد شد ولی فنی‌ترها و افراد دور و بر آن‌ها کماکان به اینترنت دسترسی خواهند داشت. یقین دارم روزی که قطعی اینترنت به شکل کامل اتفاق بیافتد، روز آخر حکومت جمهوری اسلامی و آخرین تقلا برای ماندن در مسند قدرت خواهد بود. اگر چین و روسیه نتوانسته‌اند مدل کره‌شمالی اینترنت را پیاده‌سازی کنند یقین داشته باشید که جمهوری اسلامی هم بدلایل متعدد از جمله هزینه‌های تحمیلی، عدم در اختیار داشتن نیروی متخصص کافی و دانش لازمه هرگز توانایی پیاده‌سازی بلندمدت آنرا نخواهد داشت (آیا جمهوری اسلامی مثلا توانایی تولید سیستم‌عاملی جایگزین برای اندروید، iOS، ویندوز و ... را خواهد داشت؟ به عنوان نمونه به تخمین [Open Hub](https://www.openhub.net/) بر اساس مدل [COCOMO](https://en.wikipedia.org/wiki/COCOMO)، [توسعه سیستم‌عاملی مانند اندروید ۵,۲۰۸ سال طول خواهد کشید](https://www.openhub.net/p/android)! این تنها کلاینت اندروید می‌باشد و سرویس‌های آنلاین جانبی آن نظیر نقشه، لیست‌تماس‌ها، تقویم، ایمیل، بروزرسانی و ... را شامل نمی‌شود).

بسیاری از سرویس‌هایی که لیست فوق مبتنی بر آنها کار می‌کند، بگونه‌ای مبتنی بر یکی از سرویس‌دهنده‌های CDN کار میکنند. برای مثال فیس‌بوک و طبعا اینستاگرام علاوه بر دیتاسنتر فیس‌بوک از [Akamai](https://fa.wikipedia.org/wiki/%D8%A2%DA%A9%D8%A7%D9%85%D8%A7%DB%8C) جهت هاست نمودن تصاویر و سرعت بخشیدن به استریم این فایل‌ها استفاده می‌نمایند. [آکامای به تنهایی ۱۵ تا ۳۰ درصد ترافیک وب را دراختیار دارد](https://www.reuters.com/article/us-akamai-tech-results/-strong-dollar-hurts-akamais-profit-forecast-shares-fall-idUSKBN0NJ2IV20150428).

بعنوان مثال دیگر، ترافیک ۲۹ درصد از یک میلیون وب‌سایت برتر در لیست [الکسا](https://en.wikipedia.org/wiki/Amazon_Alexa)، از سرویس مشهور و همه‌گیر [Cloudflare](https://fa.wikipedia.org/wiki/%DA%A9%D9%84%D9%88%D8%AF%D9%81%D9%84%D8%B1) میگذرد. حتی بسیاری از وب‌سایت‌های ایرانی از کلادفلیر بدلیل مزایای امنیتی نظیر سرویس [Anti-DDoS](https://fa.wikipedia.org/wiki/%DA%A9%D8%A7%D9%87%D8%B4_%D8%AD%D9%85%D9%84%D9%87_%D9%85%D9%86%D8%B9_%D8%B3%D8%B1%D9%88%DB%8C%D8%B3_%D8%AA%D9%88%D8%B2%DB%8C%D8%B9_%D8%B4%D8%AF%D9%87) آن علاوه بر سایر مزایا از قبیل گواهینامه SSL رایگان، و یا تسریع وب‌سایت‌هایشان استفاده می‌نمایند. مژده آنکه [دور زدن فیلترینگ با استفاده از Domain Fronting و  ESNI از طریق کلادفلیر](https://digi.ninja/blog/cloudflare_example.php) امکان‌پذیر می‌باشد.

تمامی این‌ها به کنار، بسیاری از وب‌سایت‌های ایرانی و خارجی از سرویس‌دهندهای کلاد برای میزبانی فایل‌های فونت، جاوااسکریپت و یا CSS مربوط به فریم‌ورک‌های مشهور وب و طراحی سایت نظیر jQuery و ... استفاده می‌نمایند. شک نداشته باشید که میلیون‌ها صفحه وب با فیلترنمودن این کلاد‌ها از کار خواهند افتاد.

در واقع Domain Fronting، نه تنها یک روش کارا و موثر به منظور دور زدن فیلترینگ اینترنت می‌باشد، بلکه در کشورهایی که دسترسی به اینترنت به طرز وحشتناکی بلوکه است، چیزی کمتر از یک انقلاب نیست، به این دلیل که:

۱. ترافیک فیلترشکن را همانند ترافیک معمولی HTTPS جلوه میدهد.

۲. اثرات جانبی بلوکه کردن آن (قطع دسترسی به سرویس‌دهنده‌های کلاد و متعاقب آن سرویس‌های مبتنی بر آن‌ها) برای سانسورچی‌ها بسیار گران تمام خواهد شد. فی‌الواقع بلاک نمودن Akamai, Cloudflare و ... به شکل جزیی یا کلی در یک کشور ۸۰ میلیونی عملی نیست که بتوان به سادگی از کنار آن گذشت و توسط شهروندان آن مورد توجه واقع نشود.

هنوز متقاعد نشده‌اید؟ یک‌بار دیگر شما را به خواندن مفهوم Collateral Freedom در ابتدای این مطلب دعوت می‌نمایم.

نکته‌ ظریفی که نباید از آن غافل شد این است که: در زمان قطعی اینترنت، بسیاری از کاربران با برپایی طوفان توییتری و امضای پتیشن از ایالات متحده خواستار اینترنت آزاد ماهواره شده بودند. در همان زمان مطلبی به رشته تحریر درآوردم که [چرا اینترنت ماهواره‌ای به شکل گسترده و یا اینترنت چمدانی و بالونی و ... خیال خام و رویای شیرینی بیش نیست](/blog/a-dream-called-satellite-internet/). بایستی عرض نمایم که اگر قصد تهیه پتیشن، برپایی طوفان توییتری و ... را دارید، بایستی در جهت راهکاری امکان پذیر و اثبات‌شده باشد که جواب خود را پس داده است. بزعم من Domain Fronting یک راهکار عالی خواهد بود. توجه داشته باشید که، درخواست فعال نمودن ویژگی Domain Fronting برای کاربران ایرانی از دولت آمریکا، آمازون، گوگل و ... و یا لابی‌گری با آن‌ها به مراتب شدنی‌تر و دست‌یافتنی‌تر از اینترنت چمدانی، بالونی یا ماهواره‌ای خواهد بود.

## تشریح فنی Domain Fronting

{{< figure src="/blog/cybersecurity-101-domain-fronting/domain-fronting-explanation.webp" alt="تشریح فنی Domain Fronting" title="تشریح فنی Domain Fronting" >}}

## meek ابزاری جهت پیاده‌سازی Domain Fronting در Tor

در دیاگرام ذیل نحوه کارکرد meek و توانایی پنهان‌سازی ترافیک شبکه Tor و جلوه دادن آن به عنوان ترافیک معمولی HTTPS با استفاده از تکنیک Domain Fronting را مشاهده می‌نمایید:

{{< figure src="/blog/cybersecurity-101-domain-fronting/meek-diagram.webp" alt="پیاده‌سازی Domain Fronting در Tor با استفاده از meek" title="پیاده‌سازی Domain Fronting در Tor با استفاده از meek" >}}

## Cloak ابزاری جهت پیاده‌سازی Domain Fronting در OpenVPN, Shadowsocks و Tor

نرم‌افزار [cbeuw/Cloak](https://github.com/cbeuw/Cloak) حاصل تحقیقات گسترده و تجربه‌های پیشین کار بر روی [شدوساکس](https://fa.wikipedia.org/wiki/%D8%B4%D8%AF%D9%88%D8%B3%D8%A7%DA%A9%D8%B3) نظیر [ShadowsocksR](https://github.com/shadowsocksrr/)، [shadowsocks/simple-obfs](https://github.com/shadowsocks/simple-obfs)، [shadowsocks/v2ray-plugin](https://github.com/shadowsocks/v2ray-plugin) و [cbeuw/GoQuiet](https://github.com/cbeuw/GoQuiet) می‌باشد.

در دیاگرام ذیل نحوه کارکرد Cloak و توانایی پنهان‌سازی ترافیک OpenVPN، Shadowsocks، و Tor و جلوه دادن آن به عنوان ترافیک معمولی HTTPS با استفاده از تکنیک Domain Fronting را مشاهده می‌نمایید:

{{< figure src="/blog/cybersecurity-101-domain-fronting/cloak-diagram.webp" alt="پیاده‌سازی Domain Fronting در OpenVPN, Shadowsocks و Tor با استفاده از Cloak" title="پیاده‌سازی Domain Fronting در OpenVPN, Shadowsocks و Tor با استفاده از Cloak" >}}

به شخصه Cloak را در شبکه اینترنت ایران تست نموده‌ام و علی‌رغم آنکه باعث کاهش سرعت در مقایسه با ShadowsocksR می‌شود (حدودا تا یک پنجم سرعت ShadowsocksR) اما به خوبی قادر به پنهان‌سازی ترافیک Shadowsocks و عبور از فیلترینگ ایران می‌باشد.
